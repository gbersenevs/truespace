# ğŸ—ï¸ ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ° TrueSpace

ĞŸĞ¾Ğ´Ñ€Ğ¾Ğ±Ğ½Ğ¾Ğµ Ğ¾Ğ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ñ‹ Ğ¾Ğ±Ñ€Ğ°Ğ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ğ¾Ğ¹ Ğ¿Ğ»Ğ°Ñ‚Ñ„Ğ¾Ñ€Ğ¼Ñ‹ TrueSpace.

## ğŸ“ ĞĞ±Ñ‰Ğ°Ñ Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      CLIENT (Browser)                        â”‚
â”‚                   React + Next.js 14                         â”‚
â”‚              TypeScript + Tailwind CSS                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â”‚ HTTP/HTTPS
                         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    RENDER (Hosting)                          â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚           Next.js Application                       â”‚    â”‚
â”‚  â”‚                                                      â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚    â”‚
â”‚  â”‚  â”‚   Frontend   â”‚         â”‚   Backend    â”‚        â”‚    â”‚
â”‚  â”‚  â”‚  (Pages/UI)  â”‚â—„â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚  (API Routes)â”‚        â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚    â”‚
â”‚  â”‚                                   â”‚                 â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                      â”‚                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                       â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                  â”‚                  â”‚
                    â–¼                  â–¼                  â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚  MongoDB Atlas   â”‚ â”‚   AWS S3     â”‚ â”‚ SMTP Server  â”‚
         â”‚   (Database)     â”‚ â”‚   (Videos)   â”‚ â”‚   (Email)    â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ—‚ï¸ Ğ¡Ñ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ°

```
truespace/
â”œâ”€â”€ app/                          # Next.js App Router
â”‚   â”œâ”€â”€ layout.tsx               # Root layout
â”‚   â”œâ”€â”€ page.tsx                 # Home page
â”‚   â”œâ”€â”€ globals.css              # Global styles
â”‚   â”‚
â”‚   â”œâ”€â”€ api/                     # API Routes
â”‚   â”‚   â”œâ”€â”€ auth/
â”‚   â”‚   â”‚   â”œâ”€â”€ register/route.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ login/route.ts
â”‚   â”‚   â”‚   â””â”€â”€ me/route.ts
â”‚   â”‚   â”œâ”€â”€ courses/
â”‚   â”‚   â”‚   â”œâ”€â”€ route.ts
â”‚   â”‚   â”‚   â””â”€â”€ [id]/route.ts
â”‚   â”‚   â”œâ”€â”€ promo/
â”‚   â”‚   â”‚   â””â”€â”€ validate/route.ts
â”‚   â”‚   â”œâ”€â”€ favorites/
â”‚   â”‚   â”‚   â””â”€â”€ route.ts
â”‚   â”‚   â””â”€â”€ admin/
â”‚   â”‚       â””â”€â”€ promo-codes/route.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ login/                   # Auth pages
â”‚   â”‚   â””â”€â”€ page.tsx
â”‚   â”œâ”€â”€ register/
â”‚   â”‚   â””â”€â”€ page.tsx
â”‚   â”œâ”€â”€ promo-access/
â”‚   â”‚   â””â”€â”€ page.tsx
â”‚   â”‚
â”‚   â”œâ”€â”€ courses/                 # Course pages
â”‚   â”‚   â”œâ”€â”€ page.tsx
â”‚   â”‚   â””â”€â”€ [id]/page.tsx
â”‚   â”‚
â”‚   â”œâ”€â”€ profile/                 # User pages
â”‚   â”‚   â””â”€â”€ page.tsx
â”‚   â”‚
â”‚   â””â”€â”€ admin/                   # Admin pages
â”‚       â”œâ”€â”€ page.tsx
â”‚       â””â”€â”€ promo-codes/page.tsx
â”‚
â”œâ”€â”€ components/                   # Reusable UI components
â”‚   â”œâ”€â”€ Button.tsx
â”‚   â”œâ”€â”€ Input.tsx
â”‚   â”œâ”€â”€ Card.tsx
â”‚   â”œâ”€â”€ Navbar.tsx
â”‚   â”œâ”€â”€ CourseCard.tsx
â”‚   â”œâ”€â”€ VideoPlayer.tsx
â”‚   â””â”€â”€ Loading.tsx
â”‚
â”œâ”€â”€ lib/                         # Utility libraries
â”‚   â”œâ”€â”€ mongodb.ts              # MongoDB connection
â”‚   â”œâ”€â”€ auth.ts                 # JWT utilities
â”‚   â”œâ”€â”€ email.ts                # Email sending
â”‚   â””â”€â”€ s3.ts                   # AWS S3 utilities
â”‚
â”œâ”€â”€ models/                      # Mongoose models
â”‚   â”œâ”€â”€ User.ts
â”‚   â”œâ”€â”€ Course.ts
â”‚   â”œâ”€â”€ Lesson.ts
â”‚   â”œâ”€â”€ PromoCode.ts
â”‚   â””â”€â”€ Progress.ts
â”‚
â”œâ”€â”€ public/                      # Static files
â”‚
â”œâ”€â”€ .env                         # Environment variables
â”œâ”€â”€ .gitignore
â”œâ”€â”€ next.config.js              # Next.js configuration
â”œâ”€â”€ tailwind.config.ts          # Tailwind CSS config
â”œâ”€â”€ tsconfig.json               # TypeScript config
â”œâ”€â”€ package.json
â”œâ”€â”€ render.yaml                 # Render deployment config
â”œâ”€â”€ README.md
â”œâ”€â”€ DEPLOYMENT.md
â””â”€â”€ ARCHITECTURE.md
```

## ğŸ”„ Data Flow

### 1. User Authentication Flow

```
User Registration:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Client  â”‚â”€â”€â”€â”€â”€â–ºâ”‚ /api/auth/   â”‚â”€â”€â”€â”€â”€â–ºâ”‚  Bcrypt  â”‚â”€â”€â”€â”€â”€â–ºâ”‚  MongoDB   â”‚
â”‚          â”‚      â”‚  register    â”‚      â”‚  Hash    â”‚      â”‚            â”‚
â”‚          â”‚â—„â”€â”€â”€â”€â”€â”¤              â”‚â—„â”€â”€â”€â”€â”€â”¤          â”‚â—„â”€â”€â”€â”€â”€â”¤            â”‚
â”‚  JWT     â”‚      â”‚  JWT Sign    â”‚      â”‚          â”‚      â”‚  User      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

User Login:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Client  â”‚â”€â”€â”€â”€â”€â–ºâ”‚ /api/auth/   â”‚â”€â”€â”€â”€â”€â–ºâ”‚  Bcrypt  â”‚â”€â”€â”€â”€â”€â–ºâ”‚  MongoDB   â”‚
â”‚          â”‚      â”‚    login     â”‚      â”‚  Compare â”‚      â”‚            â”‚
â”‚          â”‚â—„â”€â”€â”€â”€â”€â”¤              â”‚â—„â”€â”€â”€â”€â”€â”¤          â”‚â—„â”€â”€â”€â”€â”€â”¤   Query    â”‚
â”‚  JWT     â”‚      â”‚  JWT Sign    â”‚      â”‚          â”‚      â”‚            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. Promo Code Validation Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Client  â”‚â”€â”€â”€â”€â”€â–ºâ”‚ /api/promo/  â”‚â”€â”€â”€â”€â”€â–ºâ”‚  PromoCode â”‚â”€â”€â”€â”€â”€â–ºâ”‚    User    â”‚
â”‚          â”‚      â”‚  validate    â”‚      â”‚   Model    â”‚      â”‚   Model    â”‚
â”‚          â”‚      â”‚              â”‚      â”‚            â”‚      â”‚            â”‚
â”‚          â”‚      â”‚  1. Verify   â”‚      â”‚ 2. Check   â”‚      â”‚ 3. Grant   â”‚
â”‚          â”‚      â”‚     JWT      â”‚      â”‚   Valid    â”‚      â”‚   Access   â”‚
â”‚          â”‚      â”‚              â”‚      â”‚            â”‚      â”‚            â”‚
â”‚          â”‚â—„â”€â”€â”€â”€â”€â”¤  5. Return   â”‚â—„â”€â”€â”€â”€â”€â”¤ 4. Update  â”‚â—„â”€â”€â”€â”€â”€â”¤            â”‚
â”‚          â”‚      â”‚   Success    â”‚      â”‚   Uses     â”‚      â”‚            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3. Course Access Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Client  â”‚â”€â”€â”€â”€â”€â–ºâ”‚ /api/courses â”‚â”€â”€â”€â”€â”€â–ºâ”‚  MongoDB   â”‚â”€â”€â”€â”€â”€â–ºâ”‚    AWS     â”‚
â”‚          â”‚      â”‚    /[id]     â”‚      â”‚            â”‚      â”‚     S3     â”‚
â”‚          â”‚      â”‚              â”‚      â”‚            â”‚      â”‚            â”‚
â”‚  Browse  â”‚      â”‚ 1. Auth      â”‚      â”‚ 2. Query   â”‚      â”‚ 3. Video   â”‚
â”‚  Watch   â”‚      â”‚    Check     â”‚      â”‚   Course   â”‚      â”‚    URL     â”‚
â”‚  Track   â”‚      â”‚              â”‚      â”‚            â”‚      â”‚            â”‚
â”‚          â”‚â—„â”€â”€â”€â”€â”€â”¤ 5. Return    â”‚â—„â”€â”€â”€â”€â”€â”¤ 4. With    â”‚â—„â”€â”€â”€â”€â”€â”¤            â”‚
â”‚          â”‚      â”‚   Data       â”‚      â”‚   Lessons  â”‚      â”‚            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ” Security Architecture

### Authentication Layer

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Security Layers                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  1. Client Side:                                            â”‚
â”‚     - JWT stored in localStorage                            â”‚
â”‚     - Token sent in Authorization header                    â”‚
â”‚     - Automatic redirect if not authenticated               â”‚
â”‚                                                              â”‚
â”‚  2. API Routes:                                             â”‚
â”‚     - getUserFromRequest() middleware                       â”‚
â”‚     - JWT verification                                      â”‚
â”‚     - Role-based access control (RBAC)                      â”‚
â”‚                                                              â”‚
â”‚  3. Database Layer:                                         â”‚
â”‚     - Password hashing with bcrypt (salt rounds: 10)        â”‚
â”‚     - MongoDB Atlas network security                        â”‚
â”‚     - Connection string with credentials                    â”‚
â”‚                                                              â”‚
â”‚  4. S3 Security:                                            â”‚
â”‚     - IAM user with limited permissions                     â”‚
â”‚     - Bucket policies for public read                       â”‚
â”‚     - CORS configuration                                    â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Role-Based Access Control (RBAC)

```
Roles:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                           â”‚
â”‚  USER (Default):                                         â”‚
â”‚  âœ“ View courses (if hasAccessToCourses = true)          â”‚
â”‚  âœ“ Add to favorites                                      â”‚
â”‚  âœ“ Track progress                                        â”‚
â”‚  âœ“ Update own profile                                    â”‚
â”‚  âœ— Access admin panel                                    â”‚
â”‚  âœ— Create/edit courses                                   â”‚
â”‚                                                           â”‚
â”‚  ADMIN:                                                   â”‚
â”‚  âœ“ All USER permissions                                  â”‚
â”‚  âœ“ Access admin panel                                    â”‚
â”‚  âœ“ Create/edit/delete courses                           â”‚
â”‚  âœ“ Create/manage promo codes                            â”‚
â”‚  âœ“ View user analytics                                   â”‚
â”‚  âœ“ Manage all content                                    â”‚
â”‚                                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ’¾ Database Schema

### Collections Relationships

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     Users      â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚ _id            â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ email          â”‚           â”‚
â”‚ password       â”‚           â”‚ createdBy
â”‚ role           â”‚           â”‚
â”‚ favorites[]    â”‚â”€â”€â”€â”       â”‚
â”‚ savedLessons[] â”‚   â”‚       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚       â”‚
                     â”‚       â”‚
         references  â”‚       â”‚
                     â”‚       â”‚
                     â–¼       â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”
            â”‚      Courses       â”‚
            â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
            â”‚ _id                â”‚â—„â”€â”€â”€â”€â”€â”€â”
            â”‚ title              â”‚       â”‚
            â”‚ description        â”‚       â”‚ courseId
            â”‚ thumbnail          â”‚       â”‚
            â”‚ lessons[]          â”‚â”€â”€â”€â”€â”€â”€â”€â”¤
            â”‚ createdBy          â”‚       â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
                                         â”‚
                                referencesâ”‚
                                         â”‚
                                         â–¼
                                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                â”‚    Lessons     â”‚
                                â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
                                â”‚ _id            â”‚
                                â”‚ title          â”‚
                                â”‚ videoUrl       â”‚
                                â”‚ courseId       â”‚
                                â”‚ order          â”‚
                                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PromoCodes    â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚ _id            â”‚
â”‚ code           â”‚
â”‚ isActive       â”‚
â”‚ maxUses        â”‚
â”‚ currentUses    â”‚
â”‚ expiresAt      â”‚
â”‚ createdBy      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Progress     â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚ userId         â”‚
â”‚ courseId       â”‚
â”‚ lessonId       â”‚
â”‚ completed      â”‚
â”‚ watchedDurationâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Indexes

```javascript
// User Model
users.createIndex({ email: 1 }, { unique: true });

// Course Model
courses.createIndex({ title: 'text', description: 'text' });
courses.createIndex({ category: 1 });
courses.createIndex({ tags: 1 });
courses.createIndex({ isPublished: 1 });

// Lesson Model
lessons.createIndex({ courseId: 1, order: 1 });

// PromoCode Model
promocodes.createIndex({ code: 1 }, { unique: true });
promocodes.createIndex({ isActive: 1 });

// Progress Model
progress.createIndex({ userId: 1, lessonId: 1 }, { unique: true });
progress.createIndex({ userId: 1, courseId: 1 });
```

## ğŸ¨ Frontend Architecture

### Component Hierarchy

```
App Layout
â”‚
â”œâ”€â”€ Navbar (persistent)
â”‚   â”œâ”€â”€ Logo
â”‚   â”œâ”€â”€ Navigation Links
â”‚   â””â”€â”€ User Menu
â”‚
â”œâ”€â”€ Page Content (dynamic)
â”‚   â”‚
â”‚   â”œâ”€â”€ Home Page
â”‚   â”‚   â”œâ”€â”€ Hero Section
â”‚   â”‚   â”œâ”€â”€ Stats
â”‚   â”‚   â”œâ”€â”€ Featured Courses
â”‚   â”‚   â””â”€â”€ CTA Section
â”‚   â”‚
â”‚   â”œâ”€â”€ Courses Page
â”‚   â”‚   â”œâ”€â”€ Search Bar
â”‚   â”‚   â”œâ”€â”€ Filters
â”‚   â”‚   â””â”€â”€ Course Grid
â”‚   â”‚       â””â”€â”€ CourseCard (repeated)
â”‚   â”‚
â”‚   â”œâ”€â”€ Course Detail Page
â”‚   â”‚   â”œâ”€â”€ Video Player
â”‚   â”‚   â”œâ”€â”€ Course Info
â”‚   â”‚   â””â”€â”€ Lessons Sidebar
â”‚   â”‚       â””â”€â”€ Lesson Item (repeated)
â”‚   â”‚
â”‚   â”œâ”€â”€ Profile Page
â”‚   â”‚   â”œâ”€â”€ User Info Card
â”‚   â”‚   â”œâ”€â”€ Stats Cards
â”‚   â”‚   â”œâ”€â”€ Tabs (Favorites/Saved)
â”‚   â”‚   â””â”€â”€ Course Grid
â”‚   â”‚
â”‚   â””â”€â”€ Admin Pages
â”‚       â”œâ”€â”€ Dashboard
â”‚       â”œâ”€â”€ Course Management
â”‚       â””â”€â”€ Promo Code Management
â”‚
â””â”€â”€ Footer
```

### State Management

```javascript
// Global State (Client-side)
localStorage:
  - token: JWT authentication token

// Component State (React useState)
Pages:
  - user: Current user data
  - loading: Loading state
  - error: Error messages
  - data: Page-specific data

// Server State (SWR)
useSWR('/api/courses', fetcher)
  - Automatic revalidation
  - Cache management
  - Error handling
```

### Animation Strategy

```javascript
// Framer Motion Animations

1. Page Transitions:
   - Fade in: initial={{ opacity: 0 }} animate={{ opacity: 1 }}
   - Slide up: initial={{ y: 20 }} animate={{ y: 0 }}

2. Component Animations:
   - Card hover: whileHover={{ y: -8 }}
   - Button press: whileTap={{ scale: 0.98 }}
   - Scale in: initial={{ scale: 0.95 }} animate={{ scale: 1 }}

3. List Animations:
   - Staggered children with delay
   - Sequential appearance

4. Loading States:
   - Shimmer effect with CSS
   - Pulse animation for placeholders
```

## ğŸš€ Performance Optimization

### Next.js Features

```javascript
// 1. Server Components (default in App Router)
- Reduced JavaScript bundle
- Faster initial page load
- Better SEO

// 2. Image Optimization
<Image 
  src="/thumbnail.jpg" 
  width={300} 
  height={200}
  loading="lazy"
/>

// 3. Route Prefetching
<Link href="/courses"> // Automatically prefetches

// 4. API Route Caching
export const revalidate = 3600; // Cache for 1 hour
```

### Database Optimization

```javascript
// 1. Connection Pooling
mongoose.connect(MONGODB_URI, {
  bufferCommands: false,
  maxPoolSize: 10
});

// 2. Selective Field Projection
User.findById(id).select('name email role');

// 3. Populate Only When Needed
Course.find().populate('lessons', 'title duration');

// 4. Pagination
Course.find()
  .skip((page - 1) * limit)
  .limit(limit);
```

## ğŸ“Š Monitoring & Logging

### Application Logs

```javascript
// Structured Logging
console.log('[AUTH]', 'User login:', email);
console.error('[DB]', 'Connection error:', error);
console.info('[API]', 'Course created:', courseId);

// Render Logs Dashboard
- Real-time log streaming
- Search and filter
- Error tracking
```

### Metrics to Monitor

```
1. Performance:
   - Response time
   - Database query time
   - API endpoint latency

2. Usage:
   - Active users
   - Course views
   - Video plays

3. Errors:
   - Failed requests
   - Database errors
   - Authentication failures

4. Resources:
   - Memory usage
   - CPU usage
   - Disk space
```

## ğŸ”„ CI/CD Pipeline

```
Developer â†’ Git Push â†’ GitHub â†’ Render Auto-Deploy

Steps:
1. git push origin main
2. GitHub webhook triggers Render
3. Render pulls latest code
4. npm install (dependencies)
5. npm run build (Next.js build)
6. Health check
7. Switch to new deployment
8. Old deployment gracefully shutdown
```

## ğŸ›¡ï¸ Error Handling

### API Error Responses

```typescript
// Success Response
{
  success: true,
  data: { ... },
  message: "Operation successful"
}

// Error Response
{
  success: false,
  error: "Error message",
  details: "Detailed error information"
}

// HTTP Status Codes
200 - OK
201 - Created
400 - Bad Request
401 - Unauthorized
403 - Forbidden
404 - Not Found
500 - Internal Server Error
```

### Frontend Error Handling

```typescript
try {
  const response = await fetch('/api/endpoint');
  const data = await response.json();
  
  if (!response.ok) {
    throw new Error(data.error);
  }
  
  // Handle success
} catch (error) {
  // Show user-friendly error message
  setError(error.message);
}
```

## ğŸ“± Responsive Design Strategy

```
Breakpoints (Tailwind CSS):
- sm: 640px   (mobile landscape)
- md: 768px   (tablet)
- lg: 1024px  (desktop)
- xl: 1280px  (large desktop)
- 2xl: 1536px (extra large)

Layout Strategy:
- Mobile First: base styles for mobile
- Progressive Enhancement: add complexity for larger screens
- Flexible Grid: grid-cols-1 md:grid-cols-2 lg:grid-cols-3
- Responsive Typography: text-base md:text-lg lg:text-xl
```

---

Ğ­Ñ‚Ğ° Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ° Ğ¾Ğ±ĞµÑĞ¿ĞµÑ‡Ğ¸Ğ²Ğ°ĞµÑ‚:
- âœ… ĞœĞ°ÑÑˆÑ‚Ğ°Ğ±Ğ¸Ñ€ÑƒĞµĞ¼Ğ¾ÑÑ‚ÑŒ
- âœ… Ğ‘ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾ÑÑ‚ÑŒ
- âœ… ĞŸÑ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ
- âœ… ĞŸĞ¾Ğ´Ğ´ĞµÑ€Ğ¶Ğ¸Ğ²Ğ°ĞµĞ¼Ğ¾ÑÑ‚ÑŒ
- âœ… Ğ Ğ°ÑÑˆĞ¸Ñ€ÑĞµĞ¼Ğ¾ÑÑ‚ÑŒ

